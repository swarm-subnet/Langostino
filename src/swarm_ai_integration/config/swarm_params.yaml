# Swarm AI Integration Parameters Configuration

# AI Adapter Node Parameters
ai_adapter_node:
  ros__parameters:
    # LiDAR processing
    max_ray_distance: 50.0          # Maximum LiDAR range (meters)
    update_rate: 100.0               # Observation update rate (Hz)
    lidar_angle_resolution: 1.0     # Angular resolution for ray mapping (degrees)

    # Coordinate frame settings
    world_frame: "map"              # World coordinate frame
    base_frame: "base_link"         # Drone base frame

    # Data validation
    max_position_jump: 5.0          # Maximum allowed position change per update (meters)
    max_velocity: 10.0              # Maximum expected velocity (m/s)

    # Debug settings
    debug_mode: false               # Enable debug output
    publish_debug_info: true        # Publish debug topics

# AI Flight Node Parameters
ai_flight_node:
  ros__parameters:
    # Model settings
    model_path: ""                  # Path to AI model (set via launch argument)
    device: "cpu"                   # Computation device (cpu/cuda)

    # Prediction settings
    prediction_timeout: 0.1         # Maximum prediction time (seconds)
    prediction_queue_size: 1        # Size of prediction queue

    # Safety limits
    max_velocity: 3.0               # Maximum velocity command (m/s)
    max_angular_velocity: 2.0       # Maximum yaw rate (rad/s)
    safety_enabled: true            # Enable built-in safety checks

    # Performance monitoring
    log_prediction_time: false      # Log prediction timing
    log_action_commands: false      # Log action commands

# Safety Monitor Node Parameters
safety_monitor_node:
  ros__parameters:
    # Altitude limits
    max_altitude: 50.0              # Maximum flight altitude (meters)
    min_altitude: 0.5               # Minimum flight altitude (meters)

    # Velocity limits
    max_velocity: 5.0               # Maximum velocity before override (m/s)
    max_acceleration: 5.0           # Maximum acceleration (m/s²)

    # Battery monitoring
    min_battery_voltage: 14.0       # Minimum battery voltage (volts)
    critical_battery_voltage: 13.0  # Critical battery voltage (volts)

    # Geofencing
    max_distance_from_home: 100.0   # Maximum distance from takeoff point (meters)

    # Obstacle avoidance
    obstacle_danger_distance: 1.0   # Danger distance from obstacles (meters)
    obstacle_warning_distance: 2.0  # Warning distance from obstacles (meters)

    # Communication monitoring
    communication_timeout: 2.0      # Communication timeout (seconds)
    heartbeat_timeout: 5.0          # Heartbeat timeout (seconds)

    # Emergency procedures
    emergency_descent_rate: 2.0     # Emergency descent rate (m/s)
    emergency_land_timeout: 30.0    # Emergency landing timeout (seconds)

    # Failsafe actions
    failsafe_hover_duration: 5.0    # How long to hover before emergency action (seconds)
    auto_return_home: true          # Automatically return home on failsafe

    # System monitoring
    monitor_rate: 10.0              # Safety monitoring rate (Hz)
    status_publish_rate: 1.0        # Status publishing rate (Hz)

# FC Communications Node Parameters
fc_comms_node:
  ros__parameters:
    # Serial communication
    serial_port: "/dev/ttyUSB0"     # Serial port for INAV communication
    baud_rate: 115200               # Serial baud rate
    timeout: 1.0                    # Serial timeout (seconds)

    # Connection management
    reconnect_interval: 5.0         # Reconnection attempt interval (seconds)
    telemetry_rate: 10.0            # Telemetry request rate (Hz)
    heartbeat_rate: 1.0             # Heartbeat rate (Hz)

    # MSP protocol settings
    msp_timeout: 0.5                # MSP message timeout (seconds)
    max_retries: 3                  # Maximum message retries

    # Data processing
    imu_scale_accel: 0.001          # IMU accelerometer scale factor
    imu_scale_gyro: 0.001           # IMU gyroscope scale factor
    gps_coord_scale: 1e7            # GPS coordinate scale factor

# FC Adapter Node Parameters
fc_adapter_node:
  ros__parameters:
    # Velocity limits
    max_velocity: 5.0               # Maximum velocity command (m/s)
    max_yaw_rate: 180.0             # Maximum yaw rate (deg/s)
    max_acceleration: 3.0           # Maximum acceleration (m/s²)

    # Command processing
    command_timeout: 1.0            # Command timeout (seconds)
    rate_limit_enabled: true        # Enable rate limiting
    smooth_commands: true           # Enable command smoothing
    safety_checks_enabled: true     # Enable safety validation

    # Flight control
    auto_arm: false                 # Automatically arm the aircraft
    failsafe_mode: "hover"          # Failsafe behavior (hover/land/disarm)

    # MSP RC channel mapping
    rc_mid_value: 1500              # RC channel center value
    rc_range: 400                   # RC channel range (+/- from center)

    # Safety limits (absolute maximums)
    absolute_max_velocity: 10.0     # Absolute maximum velocity (m/s)
    absolute_max_yaw_rate: 360.0    # Absolute maximum yaw rate (deg/s)
    max_tilt_angle: 30.0            # Maximum tilt angle (degrees)

    # Command smoothing
    smoothing_alpha: 0.7            # Smoothing filter coefficient (0-1)
    history_length: 5               # Command history length

# LiDAR Reader Node Parameters (Front Sensor)
# front_lidar/lidar_reader_front:
#   ros__parameters:
#     # I2C communication
#     i2c_bus: 1                      # I2C bus number
#     i2c_address: 0x08               # I2C device address
#     distance_register: 0x24         # Distance data register address

#     # Sensor configuration
#     frame_id: "front_lidar_link"    # TF frame for front sensor
#     sensor_position: "front"        # Sensor mounting position
#     publish_rate: 100.0             # Publishing rate (Hz, max 100Hz per specs)

#     # Range limits
#     max_range: 50.0                 # Maximum valid range (meters)
#     min_range: 0.05                 # Minimum valid range (meters)
#     field_of_view: 0.035            # Sensor FOV (radians, ~2 degrees)

#     # Data processing
#     enable_filtering: true          # Enable distance filtering
#     filter_window_size: 5           # Moving average window size
#     max_invalid_readings: 10        # Max consecutive invalid readings before error

# LiDAR Reader Node Parameters (Down Sensor)
down_lidar/lidar_reader_down:
  ros__parameters:
    # I2C communication
    i2c_bus: 1                      # I2C bus number
    i2c_address: 0x09               # I2C device address (different from front sensor)
    distance_register: 0x24         # Distance data register address

    # Sensor configuration
    frame_id: "down_lidar_link"     # TF frame for down sensor
    sensor_position: "down"         # Sensor mounting position
    publish_rate: 100.0             # Publishing rate (Hz, max 100Hz per specs)

    # Range limits
    max_range: 50.0                 # Maximum valid range (meters)
    min_range: 0.05                 # Minimum valid range (meters)
    field_of_view: 0.035            # Sensor FOV (radians, ~2 degrees)

    # Data processing
    enable_filtering: true          # Enable distance filtering
    filter_window_size: 5           # Moving average window size
    max_invalid_readings: 10        # Max consecutive invalid readings before error